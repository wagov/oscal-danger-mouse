Mitigation Strategy ,Control Description ,Test ID ,Test Description ,Test Methodology 
Application control ,"The execution of executables, software libraries, scripts, installers, compiled",ML1-AC-01,"(Workstations) Executable files in the user profile directory and temporary folders used by the operating system, web browsers and email clients, cannot execute by a standard user.",The tester should attempt to execute a benign executable (EXE or COM) file inside of the user profile directory. The tester should be aware that subfolders within the user profile may have different behaviour depending on the configuration.
,"HTML, HTML",,,ACVT can perform path enumeration tests to assist in identifying locations within the user directories that can execute executable files. E8MVT will perform limited testing for file execution in user profiles and temporary directories.
,applications and control panel applets is,ML1-AC-02,"(Workstations) Software library files in the user profile directory and temporary folders used by the operating system, web browsers and email clients, cannot execute by a standard user.",The tester should attempt to execute a benign software library (DLL or OCX) file inside of the user profile directory. The tester should be aware that subfolders within the user profile may have different behaviour depending on the configuration.
,"prevented on workstations from within standard user profiles and temporary folders used by the operating system, web browsers and email clients.",,,E8MVT will perform limited (single folder) testing for file execution in user profiles and temporary directories.
,,ML1-AC-03,"(Workstations) Script files in the user profile directory and temporary folders used by the operating system, web browsers and email clients, cannot execute by a standard user.","The tester should attempt to execute multiple benign script (PS, VBS, BAT or JS) files inside of the user profile directory. The tester should be aware that subfolders within the user profile may have different behaviour depending on the configuration."
,,,,E8MVT will perform limited (single folder) testing for file execution in user profiles and temporary directories.
,,ML1-AC-04,"(Workstations) Installer files in the user profile directory and temporary folders used by the operating system, web browsers and email clients, cannot execute by a standard user.","The tester should attempt to execute a benign installer (MSI, MST or MSP) file inside of the user profile directory. The tester should be aware that subfolders within the user profile may have different behaviour depending on the configuration."
,,ML1-AC-05,"(Workstations) Compiled HTML files in the user profile directory and temporary folders used by the operating system, web browsers and email clients, cannot execute by a standard user.",The tester should attempt to execute a benign compiled HTML (CHM) file inside of the user profile directory. The tester should be aware that subfolders within the user profile may have different behaviour depending on the configuration.
,,ML1-AC-06,"(Workstations) HTML applications files in the user profile directory and temporary folders used by the operating system, web browsers and email clients, cannot execute by a standard user.",The tester should attempt to execute a benign HTML application (HTA) file inside of the user profile directory. The tester should be aware that subfolders within the user profile may have different behaviour depending on the configuration.
,,ML1-AC-07,"(Workstations) Control panel applet files in the user profile directory and temporary folders used by the operating system, web browsers and email clients, cannot execute by a standard user.",The tester should attempt to execute a benign control panel applet (CPL) file inside of the user profile directory. The tester should be aware that subfolders within the user profile may have different behaviour depending on the configuration.
Patch applications ,An automated method of asset discovery is used at least fortnightly to support the detection of assets for subsequent vulnerability scanning activities.,ML1-PA-01,An automated method of asset discovery is run and reviewed at least fortnightly.,Confirm that a method of asset discovery is in place (such as an asset discovery tool or a vulnerability scanner with equivalent functionality) and that it is configured to be run in an automated manner at least every fortnight. Confirm that any anomalies that are identified are reviewed and actioned.
,A vulnerability scanner with an up-to-date vulnerability database,ML1-PA-02,A vulnerability scanner with an up-to-date vulnerability database is being used for vulnerability scanning activities.,Confirm that a vulnerability scanner is in place and that the vulnerability database it uses is being updated within 24 hours prior to its use.
,is used for vulnerability scanning activities.,,,
,A vulnerability scanner is used at least daily to identify missing patches or updates for security vulnerabilities in internet-facing services.,ML1-PA-03,(Internet-Facing Services) A vulnerability scanner for internet-facing services is run and reviewed daily.,"Confirm that a vulnerability scanner is in place, and it is configured to scan the organisation’s internet-facing services. Confirm that reports from the vulnerability scanner are reviewed by the responsible staff daily, and that identified issues have been observed and actioned."
,"A vulnerability scanner is used at least fortnightly to identify missing patches or updates for security vulnerabilities in office productivity suites, web browsers and their extensions, email clients, PDF software, and security products.",ML1-PA-04,"A vulnerability scanner is run and reviewed at least fortnightly to scan the organisation’s office productivity suites, web browsers, email clients, PDF software and security products.","Confirm that a vulnerability scanner is in place, and it is configured to scan the organisation’s applications listed, typically requiring a credentialed scan. Confirm that reports from the vulnerability scanner are reviewed by the responsible staff fortnightly, and that identified issues have been observed and actioned."
,"Patches, updates or vendor mitigations for security vulnerabilities in internet-facing services are applied within two weeks of release, or within 48 hours if an exploit exists.",ML1-PA-05,(Internet-Facing Services) The organisation has a process for identifying vulnerabilities in internet-facing services within 48 hours and has an example of where an available exploit has been identified and patched within 48 hours.,Review the process in place for identifying vulnerabilities in internet-facing systems. Request evidence of the identification and patching of a system that contained an exploitable vulnerability within the environment.
,,ML1-PA-06,(Internet-Facing Services) Applications with an exploit that has been available for greater than 48 hours are patched or mitigated.,Use a vulnerability scanner to identify applications within the environment and check that they have been patched against a known exploit. Determine the date the patch was installed and compare to when the patch was made available.
,,ML1-PA-07,(Internet-Facing Services) Applications are patched or mitigated within two weeks.,Use a vulnerability scanner to identify applications within the environment and check that they have been patched against a known exploit. Determine the date the patch was installed and compare to when the patch was made available.
,"Patches, updates or vendor mitigations for security vulnerabilities in office productivity suites, web browsers and their extensions, email clients, PDF software, and security products are applied within one month of release.",ML1-PA-08,"The organisation has an effective process for patching office productivity suites, web browsers, email clients, PDF software and security products within one month.","Confirm the existence of a list of applications, and where the applications are installed. Ensure a process for identifying vulnerabilities for software in the list is consistently followed. Request evidence of the patching of these applications within one month."
,,ML1-PA-09,"Office productivity suites, web browsers, email clients, PDF software and security products do not have security vulnerabilities older than one month.","Use a vulnerability scanner to identify the listed applications within the organisation’s environment, and check that they have been patched against a known exploit. Check the date the application was updated and compare to the date the patch was released. Ensure that the gap between is not greater than one month."
,,,,E8MVT will perform basic checks of some Microsoft Office applications based on version numbers and file modification dates to determine if the software has been updated recently.
,"Internet-facing services, office productivity suites, web browsers and their extensions, email clients, PDF software, Adobe Flash Player,",ML1-PA-10,The organisation has removed unsupported internet-facing services from the environment.,Confirm that the environment does not contain software on internet-facing systems that is no longer supported by the vendor. Use a vulnerability scanner to identify applications within the environment and check they are supported.
,,ML1-PA-11,"The organisation has removed unsupported office productivity suites, web browsers, email clients, PDF software and security products from the environment.",Confirm that the environment does not contain any of the listed software that is no longer supported by the vendor. Use a vulnerability scanner to identify applications within the environment and check they are supported.
,and security products that are no longer supported by vendors are removed.,,,
Configure Microsoft Office macro settings ,Microsoft Office macros are disabled for users that do not have a demonstrated business requirement.,ML1-OM-01,A technical solution exists that blocks Microsoft Office macros for users who are not approved under the Microsoft Office macro policy.,Run RSOP on workstations to identify the Microsoft Office macro security settings applied by group policy settings. This should typically be set to ‘Disable without notification’. Note ‘Disable with notification’ allows users to bypass this control and does not meet the intent. Check for Active Directory security groups that enforce Microsoft Office macro blocking.
,,,,Test running Microsoft Office macros on a user in the disallowed group. E8MVT will attempt to execute a Microsoft Office macro within a document.
,,ML1-OM-02,"A record is kept of users that have been approved to allow Microsoft Office macro execution, and this list matches the list of users within the technical solution.","Confirm a repository of approved requests for users to execute Microsoft Office macros is maintained and up to date and matches the technical implementation. Typically, this means the Active Directory Security Group that permits Microsoft Office macro use should match the list of users who have been approved to run Microsoft Office macros."
,Microsoft Office macros in files originating from the internet are blocked.,ML1-OM-03,Microsoft Office files from the internet are unable to execute Microsoft Office macros.,Attempt to run Microsoft Office macros in Microsoft Office files from the internet. Confirm these files are blocked when received by download and email. Do this for all installed Microsoft Office applications.
,,,,E8MVT will open a test file that contains a zone identifier to indicate it is from the internet.
,,ML1-OM-04,Microsoft Office has been configured to block Microsoft Office macros from running in Microsoft Office files from the internet.,Check if the following group policy setting is enabled. Do this for all installed Microsoft Office applications User 
,,,,Configuration/Policies/Administrative Templates/Microsoft <Application><Version>/Application Settings/Security/Trust Center/Block macros from running in Office files from the internet.
,,,,Check if the following registry value exists and is set to 1. Do this for all installed Microsoft Office applications
,,,,Computer\HKEY_CURRENT_USER\SOFTWARE\Policies\Microsoft\office\<version>\<Application>\security\blockcontentexecutionfr omInternet.
,,,,E8MVT will check that these registry settings are configured to the correct setting.
,,,,Get-ItemProperty -Path “HKCU:\SOFTWARE\Policies\Microsoft\office\<version>\<application>\security\” | Select-Object Property blockcontentexecutionfromInternet 
,,,,Example: Get-ItemProperty -Path “HKCU:\SOFTWARE\Policies\Microsoft\office\16.0\excel\security\” | Select-Object -Property blockcontentexecutionfromInternet
,Microsoft Office macro antivirus scanning is enabled.,ML1-OM-05,The system has macroruntimescope enabled for Microsoft Office applications in registry settings or has an alternative Microsoft Office macro scanning ability in place.,Check if the following group policy setting is enabled for all Microsoft Office applications User 
,,,,Configuration/Policies/Administrative Templates/Microsoft Office <Version>/Security Settings/Macro Runtime Scan Scope.
,,,,E8MVT will check the registry to confirm that the policy setting is configured.
,,ML1-OM-06,System anti-virus successfully detects a virus test signature inside of a Microsoft Office macro in a Microsoft Office file.,Attempt to run a pseudo malicious Microsoft Office macro that contains an EICAR test string. E8MVT will open a test file containing a Microsoft Office macro that will write the EICAR test string to a file.
,Microsoft Office macro security settings cannot be changed by users.,ML1-OM-07,A standard user is unable to modify the security settings for Microsoft Office macros in all Microsoft Office applications.,Open the application and attempt to change the Microsoft Office macro security settings in the Trust Center. Do this for all installed Microsoft Office applications.
User application hardening ,Web browsers do not process Java from the internet.,ML1-AH-01,Java content does not execute in Microsoft Edge.,Load a website with known Java content and check if it renders in the web browser. Check the registry keys at HKLM:\SOFTWARE\Oracle\JavaDeploy\WebDeployJava and HKLM:\SOFTWARE\JavaSoft\Java Plug-in\.
,,,,Get-ItemProperty -Path “HKLM:\SOFTWARE\Oracle\JavaDeploy\WebDeployJava” 
,,,,Get-ItemProperty -Path “HKLM:\SOFTWARE\JavaSoft\Java Plug-in” 
,,ML1-AH-02,Java content does not execute in Google Chrome.,Load a website with known Java content and check if it renders in the web browser.
,,ML1-AH-03,Java content does not execute in Mozilla Firefox.,Load a website with known Java content and check if it renders in the web browser.
,Web browsers do not process web advertisements from the internet.,ML1-AH-04,Web ads do not display in Microsoft Edge.,Load a website in Microsoft Edge with known ads and check if it renders in the web browser. Check the ‘Block ads on sites that show intrusive or misleading ads’ setting is configured. Check if any ad blocking plugins are configured in the web browser.
,,ML1-AH-05,Web ads do not display in Google Chrome.,Load a website in Google Chrome with known ads and check if it renders in the web browser. Check the ‘Block ads on sites that show intrusive or misleading ads’ setting is configured. Check if any ad blocking plugins are configured in the web browser.
,,ML1-AH-06,Web ads do not display in Mozilla Firefox.,Load a website in Mozilla Firefox with known ads and check if it renders in the web browser. Check if any ad blocking plugins are configured in the web browser.
,Internet Explorer 11 does not process content from the internet.,ML1-AH-07,Internet Explorer 11 is unable to connect to internet sites. Internet Explorer 11 may be allowed to access internal web applications only.,"If Internet Explorer 11 is installed, access an external website using the web browser and ensure it is blocked. If it is not installed, use a manual request method (script, curl, proxy) with modified request headers to imitate IE (e.g. User-Agent) and check if the request is blocked. Review proxy or firewall configuration for the existence of rules to prevent IE specific browsing from reaching the internet."
,Web browser security settings cannot be changed by users.,ML1-AH-08,Microsoft Edge settings cannot be changed by a standard user.,"Check that group policy settings are configured for Microsoft Edge. Open the web browser configuration panel and look for existence of a ‘Managed by organisation’ message or similar. Attempt to change a setting related to networking or security, such as blocking of ads, proxy settings or security level."
,,ML1-AH-09,Google Chrome settings cannot be changed by a standard user.,"Check that group policy settings are configured for Google Chrome. Open the web browser configuration panel and look for existence of a ‘Managed by organisation’ message or similar. Attempt to change a setting related to networking or security, such as blocking of ads, proxy settings or security level."
,,ML1-AH-10,Mozilla Firefox settings cannot be changed by a standard user.,"Check that group policy settings are configured for Mozilla Firefox. Open the web browser configuration panel and look for existence of a ‘Managed by organisation’ message or similar. Attempt to change a setting related to networking or security, such as blocking of ads, proxy settings or security level."
,,ML1-AH-11,Internet Explorer 11 settings cannot be changed by a standard user.,"Check that group policy settings are configured for Internet Explorer 11. Open the web browser configuration panel and look for existence of a ‘Managed by organisation’ message or similar. Attempt to change a setting related to networking or security, such as blocking of ads, proxy settings or security level."
Restrict administrative privileges ,Requests for privileged access to systems and applications are validated when first requested.,ML1-RA-01,A process exists and is enforced for granting privileged access to systems.,"Confirm the organisation has a documented, approved and enforced privileged access process that outlines the requirements for provisioning a privileged account to a system or application. Confirm the organisation has a list of systems and applications that require privileged access."
,,,,Review documented privileged access process and systems. Request evidence of process being followed (e.g. support tickets).
,"Privileged accounts (excluding privileged service accounts) are prevented from accessing the internet, email and web services.",ML1-RA-02,Privileged accounts (excluding privileged service accounts) cannot access the internet or web services via a web browser or other mechanism.,"While logged in as a privileged user, attempt to browse to an internet website. Review the configuration preventing internet access and attempt to change this as a privileged user not responsible for administering that system. Privileged accounts not responsible for administering these systems should not be able to change settings to access the internet."
,,,,"While privileged account policies should be reviewed, they do not satisfy this control without additional technical mechanisms."
,,ML1-RA-03,Privileged accounts are not configured with mailboxes and email addresses.,Attempt to open Microsoft Outlook on a system using the privileged account.
,,,,"Run the following PowerShell command Get-ADUser -Filter {(admincount -eq 1) -and (emailaddress -like “*”) -and (enabled -eq $true)} -Properties EmailAddress | Select samaccountname, emailaddress"
,Privileged users use separate privileged and unprivileged operating environments.,ML1-RA-04,All administrative activities are performed in an administrative environment that is segmented from the standard user network environment. A separate environment is provisioned for the use of privileged access and is not used for any other purpose.,"Attempt to access the administrative network environment using a standard account. Attempt to access the standard environment using a privileged account. Look for evidence of administrative access to unprivileged environments, using tools such as Bloodhound. Check for the existence of workstations that exist solely for privileged access purposes."
,,,,"The privileged operating environment must not be virtualised within the unprivileged operating environment for Maturity Level Two or Maturity Level Three. However, it can be for Maturity Level One."
,Unprivileged accounts cannot logon to privileged operating environments.,ML1-RA-05,Unprivileged accounts are not able to logon to systems in the privileged environment.,Use Bloodhound to analyse Active Directory data and look for which users and groups have RDP access to servers. Review group policy settings for RDP permissions.
,,ML1-RA-06,Unprivileged user prevented from using the PowerShell remote PSRemote windows feature.,Run the following PowerShell command (Get-PSSessionConfiguration -Name Microsoft.PowerShell).Permission Check the members of the built-in Active Directory Security Group Remote Management Users.
,Privileged accounts (excluding local administrator accounts) cannot logon to unprivileged operating environments.,ML1-RA-07,"A privileged account cannot be used to authenticate and interactively login to standard user workstations, or other unprivileged environments. Limitedpermission administrative accounts can be used to meet business requirements in unprivileged environments, such as for help desk personnel.",Attempt to login with a privileged account to a standard user workstation. Check group policy settings for ‘Deny logon locally’ and ‘Deny log on through Remote Desktop Services user rights’ to workstations for privileged accounts.
,,,,"Limited-permission administrative accounts can be used to meet business requirements in unprivileged environments, such as for help desk personnel. These accounts should not be highly privileged."
,,,,"Review list of administrative users who can login to unprivileged environments. None of the users should be highly privileged, for example Domain Administrators. These users should not be able to access the privileged environment."
,,ML1-RA-08,An unprivileged account logged into a standard user workstation cannot raise privileges to a privileged user.,"While logged in as a standard user, attempt to use ‘runas’ to open an application as an administrator. Attempt other ways (e.g. WinRM, Computer Management or RDP) to escalate privileges to an administrator."
Patch operating systems ,An automated method of asset discovery is used at least fortnightly to support the detection of assets for subsequent vulnerability scanning activities.,ML1-PO-01,An automated method of asset discovery is run and reviewed at least fortnightly.,Confirm that a method of asset discovery is in place (such as an asset discovery tool or a vulnerability scanner with equivalent functionality) and that it is configured to be run in an automated manner at least every fortnight. Confirm that any anomalies that are identified are reviewed and actioned.
,A vulnerability scanner with an up-to-date vulnerability database is used for vulnerability scanning activities.,ML1-PO-02,A vulnerability scanner with an up-to-date vulnerability database is being used for vulnerability scanning activities.,Confirm that a vulnerability scanner is in place and that the vulnerability database it uses is being updated within 24 hours prior to its use.
,A vulnerability scanner is used at least daily to identify missing patches or updates for security vulnerabilities in operating systems of internet-facing services.,ML1-PO-03,A vulnerability scanner is run and reviewed daily to scan the organisation’s internet-facing services.,"Confirm that a vulnerability scanner is in place, and it is configured to scan the organisation’s internet-facing services. Confirm that reports from the vulnerability scanner are reviewed by the responsible staff daily, and that identified issues have been observed and actioned."
,A vulnerability scanner is used at least fortnightly to identify missing patches or,ML1-PO-04,A vulnerability scanner is run and reviewed at least fortnightly to scan the organisation’s operating systems.,"Confirm that a vulnerability scanner is in place, and it is configured to scan the organisation’s operating systems, typically requiring a credentialed scan. Confirm that reports from the vulnerability scanner are reviewed by the responsible staff fortnightly, and that identified issues have been observed and actioned."
,"updates for security vulnerabilities in operating systems of workstations, servers and network devices.",,,
,"Patches, updates or vendor mitigations for security vulnerabilities in operating systems of internet-facing services are applied within two weeks of release, or within 48 hours if an exploit exists.",ML1-PO-05,The organisation has an example of where an available exploit has been identified and patched within 48 hours.,"If available, request evidence of the identification and patching of a system that contained an exploitable vulnerability within the environment."
,,ML1-PO-06,Internet-facing system that have a vulnerable operating system with an exploit that has been available for greater than 48 hours are patched or mitigated.,"View vulnerability management solution, logon to server to verify patch applied successfully or review mitigation strategy."
,,,,E8MVT will assesses based on most recently installed critical patch. Does not test for existing exploits or 48-hour timeframe requirements.
,,ML1-PO-07,Internet-facing systems that have a vulnerable operating system are patched or mitigated within two weeks.,Use vulnerability management solution to perform a patch audit of servers.
,,,,"Retrieve the update history of the workstation, noting the release date of the patch and the date it was installed. Look for differences greater than two weeks."
,"Patches, updates or vendor mitigations for security vulnerabilities in operating systems of workstations, servers and network devices are applied within one month of release.",ML1-PO-08,The organisation has an effective process for patching operating systems within one month.,"Confirm the existence of a list of managed operating systems, and where they are located. Ensure a process for identifying vulnerabilities for operating systems in the list is consistently followed. Request evidence of the patching of these systems within one month."
,,ML1-PO-09,Operating systems that have a vulnerability are patched or mitigated within one month.,Use a vulnerability management solution to perform a patch audit of all systems.
,,,,"Retrieve the update history of the systems in scope, noting the release date of the patch and the date it was installed. Look for differences greater than one month."
,Operating systems that are no longer supported by vendors are replaced.,ML1-PO-10,The organisation has removed unsupported operating systems from the environment.,Confirm that the environment does not contain any operating systems no longer supported by the vendor. Use a vulnerability scanner to identify operating systems within the environment and check they are supported.
Multi-factor authentication ,Multi-factor authentication is used by an organisation’s users if they authenticate to their organisation’s internet-facing services.,ML1-MF-01,The organisation has a verified and approved list of internet-facing services operating within the organisation.,Confirm an approved list of internet-facing services exists and this list is regularly checked.
,,ML1-MF-02,The organisational remote access desktop solution presents a MFA challenge when attempting to authenticate.,Verify the user is presented with a MFA challenge when authenticating to the organisation’s remote solution.
,,ML1-MF-03,Organisational internet-facing systems present a MFA challenge when attempting to authenticate.,Verify the user is presented with a MFA challenge when authenticating to the organisation’s internet-facing systems.
,"Multi-factor authentication is used by an organisation’s users if they authenticate to thirdparty internet-facing services that process, store or communicate their organisation’s sensitive data.",ML1-MF-04,Third-party internet-facing services that hold sensitive data are configured to require users to use MFA.,Verify the organisation’s sensitive third-party internet-facing services are configured with MFA. Confirm the organisation has a policy that MFA will be implemented on all third-party internet-facing services that hold sensitive data.
,"Multi-factor authentication (where available) is used by an organisation’s users if they authenticate to third-party internetfacing services that process, store or communicate their organisation’s nonsensitive data.",ML1-MF-05,Third-party internet-facing services that hold non-sensitive data are configured to require users to use MFA.,Verify the organisation’s third-party internet-facing services are configured with MFA. Confirm the organisation has a policy that MFA will be implemented on all third-party internet-facing services that hold non-sensitive data.
,Multi-factor authentication is enabled by default for non-organisational users (but users can choose to opt out) if they authenticate to an organisation’s internet-facing services.,ML1-MF-06,The organisational internet-facing services with non-organisational user presents a multi-factor challenge when attempting to authenticate by default.,Verify non-organisational users are presented with a MFA challenge when accessing organisational systems by default. Users may elect to opt out of this feature.
Regular backups ,"Backups of important data, software and configuration settings are performed and retained with a frequency and retention timeframe in accordance with business continuity requirements.",ML1-RB-01,"The organisation has a business continuity plan (BCP) that outlines their important data, software and configuration settings that require backing up.","Request the current BCP. Note when the BCP was last modified as old BCPs often don’t reference the current environment. Confirm the organisation has a defined list of important data, software and configuration settings."
,,ML1-RB-02,"Important data, software and configuration settings are backed up and retained as per the timeframes outlined within the BCP.","Verify important data, software and configuration settings are backed up and retained in accordance with the BCP."
,"Backups of important data, software and configuration settings are synchronised to enable restoration to a common point in time.",ML1-RB-03,"Important data, software and configuration settings are backed up in a synchronised manner using a common point in time.","Verify important data, software and configuration settings are backed up in a synchronised manner using a common point in time."
,"Backups of important data, software and configuration settings are retained in a secure and resilient manner.",ML1-RB-04,"Important data, software and configuration settings are backed up and retained in a secure and resilient manner.","Verify important data, software and configuration settings are backed up and retained in a secure and resilient manner."
,"Restoration of important data, software and configuration settings from backups to a",ML1-RB-05,"The organisation has documented evidence of a disaster recovery exercise being performed. This includes examples of where important data, software and configuration settings have been restored from backups.","Verify the organisation has conducted a disaster recovery exercise. Verify the organisation has successfully restored important data, software and configuration settings as part of this exercise. Confirm the existence of a disaster recovery plan (DRP), and ensure it is appropriate, relevant, and followed during incidents and exercises."
,common point in time is tested as part of disaster recovery exercises.,,,
,Unprivileged accounts cannot access backups belonging to other accounts.,ML1-RB-06,Unprivileged users are unable to access backups that do not belong to them.,Verify access controls restrict access to only the owner of the information.
,Unprivileged accounts are prevented from modifying and deleting backups.,ML1-RB-07,Unprivileged users are unable to modify and delete backups.,Verify access controls restrict the modification and deletion of backups.
 , ,,,
Application control ,Application control is implemented on workstations and internet-facing servers. ,ML2-AC-01,(Workstations & Internet-facing servers) A dedicated application control solution is implemented.,Check whether an in-built or third-party application control solution has been implemented.
,"Application control restricts the execution of executables, software libraries,",ML2-AC-02,(Workstations & Internet-facing servers) The system is only able to execute approved executables.,"Attempt to execute an unapproved, benign executable. Depending on the policy, there may be directories or specific versions of software that may be allowed to run, but might not be organisationally approved. The tester will have to consider possible policy bypass locations when performing this test."
,"scripts, installers,",,,E8MVT will attempt to run an exe file within the local AppData temp directory. ACVT will recursively copy an exe file to the file system and attempt to execute it.
,"compiled HTML, HTML applications and control panel applets to an organisationapproved set.",ML2-AC-03,(Workstations & Internet-facing servers) The system is only able to execute approved software libraries.,"Attempt to execute an unapproved, benign software library. Depending on the policy, there may be directories or specific versions of software that may be allowed to run, but might not be organisationally approved. The tester will have to consider possible policy bypass locations when performing this test."
,,,,E8MVT will attempt to run a dll file within the local AppData temp directory. ACVT will recursively copy a dll file to the file system and attempt to execute it.
,,ML2-AC-04,(Workstations & Internet-facing servers) The system is only able to execute approved scripts.,"Attempt to execute an unapproved, benign scripts. Depending on the policy, there may be directories or specific versions of software that may be allowed to run, but might not be organisationally approved. The tester will have to consider possible policy bypass locations when performing this test."
,,,,E8MVT will attempt to run multiple script files within the local AppData temp directory. ACVT will recursively copy multiple script files to the file system and attempt to execute them.
,,ML2-AC-05,(Workstations & Internet-facing servers) The system is only able to execute approved installers.,"Attempt to execute an unapproved, benign installers. Depending on the policy, there may be directories or specific versions of software that may be allowed to run, but might not be organisationally approved. The tester will have to consider possible bypass locations when performing this test."
,,,,E8MVT will attempt to run a MSI file that will install a text file into the local AppData temp directory.
,,ML2-AC-06,(Workstations & Internet-facing servers) The system is only able to execute approved compiled HTML files.,"Attempt to execute an unapproved benign compiled HTML file. Depending on the policy, there may be directories or specific versions of software that may be allowed to run, but might not be organisationally approved. The tester will have to consider possible bypass locations when performing this test."
,,,,The tester should first test that HH.exe is allowed to execute. If HH.exe is unable to execute than further testing may not be required.
,,,,E8MVT will attempt to run a compiled HTML file within the local AppData temp directory.
,,ML2-AC-07,(Workstations & Internet-facing servers) The system is only able to execute approved HTML applications.,"Attempt to execute an unapproved, benign HTML applications. Depending on the policy, there may be directories or specific versions of software that may be allowed to run, but might not be organisationally approved. The tester will have to consider possible bypass locations when performing this test."
,,,,The tester should first test that MSHTA.exe is allowed to execute. If MSHTA.exe is unable to execute than further testing may not be required.
,,,,E8MVT will attempt to run an HTML Application file within the local AppData temp directory.
,,ML2-AC-08,(Workstations & Internet-facing servers) The system is only able to execute an approved control panel applets.,"Attempt to execute an unapproved benign control panel applet. Depending on the policy, there may be directories or specific versions of software that may be allowed to run, but might not be organisationally approved. The tester will have to consider possible bypass locations when performing this test."
,,,,The tester should first test that CONTROL.exe is allowed to execute. If CONTROL.exe is unable to execute than further testing may not be required.
,,,,E8MVT will attempt to run a Control Panel Applet file within the local AppData temp directory.
,Allowed and blocked execution events on workstations and internet-facing servers are logged. ,ML2-AC-09,(Workstations & Internet-facing servers) The system is logging the application control product when it allows and blocks execution.,Verify event logs contain required data (does not require central storage). Ensure all systems are logging.
Patch applications ,"A vulnerability scanner is used at least weekly to identify missing patches or updates for security vulnerabilities in office productivity suites, web browsers and their extensions, email clients, PDF software, and security products.",ML2-PA-01,"A vulnerability scanner is run and reviewed at least weekly to scan the organisation’s office productivity suites, web browsers, email clients, PDF software and security products.","Confirm that a vulnerability scanner is in place, and it is configured to scan the organisation’s applications listed, typically requiring a credentialed scan. Confirm that reports from the vulnerability scanner are reviewed by the responsible staff weekly, and that identified issues have been observed and actioned."
,A vulnerability scanner is used at least fortnightly to identify missing patches or updates for security vulnerabilities in other applications. ,ML2-PA-02,A vulnerability scanner is run and reviewed at least fortnightly to scan the organisation’s other applications.,"Confirm that a vulnerability scanner is in place, and it is configured to scan the organisation’s other applications, typically requiring a credentialed scan. Confirm that reports from the vulnerability scanner are reviewed by the responsible staff fortnightly, and that identified issues have been observed and actioned."
,"Patches, updates or vendor mitigations for security vulnerabilities in office productivity suites, web browsers and their extensions, email clients, PDF software, and security products are applied within two weeks of release. ",ML2-PA-03,"The organisation has an effective process for patching office productivity suites, web browsers, email clients, PDF software and security products within two weeks.","Confirm the existence of a list of applications, and where the applications are installed. Ensure a process for identifying vulnerabilities for software in the list is consistently followed. Request evidence of the patching of these applications within two weeks."
,,ML2-PA-04,"Office productivity suites, web browsers, email clients, PDF software and security products do not have security vulnerabilities older than two weeks.","Use a vulnerability scanner to identify the listed applications within the organisation’s environment, and check that they have been patched against a known exploit. Check the date the application was updated and compare to the date the patch was released. Ensure that the gap between is not greater than two weeks."
,"Patches, updates or vendor mitigations for security vulnerabilities in other applications are applied within one month of release. ",ML2-PA-05,Other applications that have a vulnerability are patched or mitigated within one month.,"Use a vulnerability scanner to identify vulnerable applications within the organisation’s environment, and check that they have been patched against a known exploit. Check the date the application was updated and compare to the date the patch was released. Ensure that the gap between is not greater than one month."
Configure Microsoft Office macro settings ,Microsoft Office macros are blocked from making Win32 ,ML2-OM-01,Microsoft Office macros in Microsoft Office files are unable to make Win32 API calls.,Open a file that contains a Microsoft Office macro that makes a Win32 API call. Do this for all installed Microsoft Office applications. E8MVT can assist with this test.
,API calls. ,,,
,Allowed and blocked Microsoft Office macro execution events are logged. ,ML2-OM-02,Allowed execution of a Microsoft Office macro within a Microsoft Office file is logged.,Check that TrustCenter logging is enabled by checking the Enable Logging registry key at HKCU:\Software\Microsoft\Office\16.0\Common\TrustCenter\.
,,,,Get-ItemProperty -Path “HKCU:\Software\Microsoft\Office\<version>\Common\TrustCenter\” | Select-Object -Property 
,,,,EnableLogging 
,,,,Example: Get-ItemProperty -Path “HKCU:\Software\Microsoft\Office\16.0\Common\TrustCenter\” | Select-Object -Property EnableLogging
,,,,Request evidence of event logs for allowed Microsoft Office macro execution events.
,,ML2-OM-03,Blocked execution of a Microsoft Office macro within a Microsoft Office file is logged.,Check that TrustCenter logging is enabled by checking the EnableLogging registry key at HKCU:\Software\Microsoft\Office\16.0\Common\TrustCenter\.
,,,,Example: Get-ItemProperty -Path “HKCU:\Software\Microsoft\Office\16.0\Common\TrustCenter\” | Select-Object -Property 
,,,,Request evidence of event logs for blocked Microsoft Office macro execution events. Microsoft Office macros blocked due to AV can be found in the Event Viewer.
User application hardening ,Microsoft Office is blocked from creating child processes. ,ML2-AH-01,Microsoft Office files cannot create child processes.,"Open a file that contains a Microsoft Office macro that will create a child process. Confirm it is unable to do this. Check the ASR rule ‘d4f940ab-401b-4efc-aadc-ad5f3c50688a’ is configured in block mode, or another solution is in place to prevent creation of child processes."
,,,,"Running E8MVT will confirm if the ASR rule to prevent creation of child processes is enabled, or if child process creation has been blocked through a PowerShell command. Running E8MVT will execute a test that opens a file containing a Microsoft Office macro that creates a child process."
,,,,$ASR_Rules = Get-MPPreference | Select -ExpandProperty AttackSurfaceReductionRules_Ids  
,,,,$match = $false 
,,,,Foreach($rules in $ASR_Rules) {If ($rules -match “d4f940ab-401b-4efc-aadc-ad5f3c50688a”) {$match = $true}} 
,,,,If($match -eq $true) {Write-Output(“Block all Office applications from creating child processes (d4f940ab-401b-4efc-aadcad5f3c50688a) is enabled”)} else {Write-Output(“Block all Office applications from creating child processes (d4f940ab-401b-4efcaadc-ad5f3c50688a) is not present or disabled”)} 
,Microsoft Office is blocked from creating executable content. ,ML2-AH-02,Microsoft Office files cannot create executable content.,"Open a file that contains a Microsoft Office macro that will create executable content. Confirm it is unable to do this. Check the ASR rule ‘3b576869-a4ec-4529-8536-b80a7769e899’ is configured in block mode, or another solution is in place to prevent creation of executable content."
,,,,Running E8MVT will confirm if the ASR rule to creation of executable content is enabled. Running E8MVT will execute a test that opens a file containing a Microsoft Office macro that creates executable content.
,,,,Foreach($rules in $ASR_Rules) {If ($rules -match “3b576869-a4ec-4529-8536-b80a7769e899”) {$match = $true}} 
,,,,If($match -eq $true) {Write-Output(“Block Office applications from creating executable content (3b576869-a4ec-4529-8536b80a7769e899) is enabled”)} else {Write-Output(“Block Office applications from creating executable content (3b576869-a4ec4529-8536-b80a7769e899) is not present or disabled”)} 
,Microsoft Office is blocked from injecting code into other processes. ,ML2-AH-03,Microsoft Office files cannot inject code into other processes.,"Open a file that contains a Microsoft Office macro that will inject code into another process. Confirm it is unable to do this. Check the ASR rule ‘75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84’ is configured in block mode, or another solution is in place to prevent code injection."
,,,,Running E8MVT will confirm if the ASR rule to prevent injection of code into other processes is enabled. Running E8MVT will execute a test that opens a file containing a Microsoft Office macro that will attempt to inject code into the explorer.exe process.
,,,,Foreach($rules in $ASR_Rules) {If ($rules -match “75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84”) {$match = $true}} 
,,,,If($match -eq $true) {Write-Output(“Block Office applications from injecting code into other processes (75668C1F-73B5-4CF0-
,,,,BB93-3ECF5CB7CC84) is enabled”)} else {Write-Output(“Block Office applications from injecting code into other processes (75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84) is not present or disabled”)}
,Microsoft Office is configured to prevent activation of OLE packages. ,ML2-AH-04,Microsoft Office files do not execute OLE packages.,Open a file that contains an OLE object. Check the PackagerPrompt registry key within the Trust Center settings is set to 2.
,,,,E8MVT will check the required registry key.
,,,,Get-ItemProperty -Path “HKCU:\SOFTWARE\Microsoft\office\<version>\<application>\security\” | Select-Object -Property PackagerPrompt 
,,,,Example: Get-ItemProperty -Path “HKCU:\SOFTWARE\Microsoft\office\16.0\excel\security\” | Select-Object -Property 
,,,,PackagerPrompt
,Microsoft Office security settings cannot be changed by users. ,ML2-AH-05,Microsoft Office security setting are unable to be modified by a standard user account.,Attempt to modify security settings in Microsoft Office. Check that the vbawarnings registry key is configured via policy and that a user is unable to change the Microsoft Office macro settings within the Trust Center options.
,,,,Get-ItemProperty -Path “HKCU:\SOFTWARE\Policies\Microsoft\office\<version>\<application>\security\” | Select-Object -
,,,,Property vbawarnings 
,,,,Example: Get-ItemProperty -Path “HKCU:\SOFTWARE\Policies\Microsoft\office\16.0\excel\security\” | Select-Object -Property vbawarnings
,PDF software is blocked from creating child processes. ,ML2-AH-06,PDF software cannot create child processes.,"Adobe Reader can be tested by opening the application, selecting Open from the File menu, selecting ‘All Files (*.*)’ from the dropdown menu in the corner, browsing to system32 folder, find calc.exe. Right click and select Open."
,,,,Check ASR rule 7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c is enabled. Can also run Get-ProcessMitigation -Name acrobat.exe).ChildProcess.DisallowChildProcessCreation to check if it has been disabled this way. E8MVT will check that the Adobe child process creation ASR rule is enabled.
,,,,Foreach($rules in $ASR_Rules) {If ($rules -match “7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c”) {$match = $true}}  
,,,,If($match = $true) {Write-Output(“Block Adobe Reader from creating child processes (7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c) is enabled”)} else {Write-Output(“Block Adobe Reader from creating child processes (7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c) is not present or disabled”)}
,PDF software security settings cannot be changed by users. ,ML2-AH-07,PDF software security settings are unable to be modified by a standard user account.,Attempt to modify security settings within all allowed PDF readers.
,,ML2-AH-08,The Microsoft guidance for hardening Microsoft Edge is implemented.,Use the Microsoft Policy Analyzer to validate the effective state of the system against the Microsoft Edge security baseline.
,"ACSC or vendor hardening guidance for web browsers, Microsoft Office and PDF software is implemented. ",ML2-AH-09,The Google guidance for hardening Google Chrome is implemented.,Determine if Google Chrome is configured via group policy settings and if the configured settings are in line with the Chrome Browser Enterprise Security Configuration Guide provided by Google at https://support.google.com/chrome/a/answer/9710898?hl=en.
,,ML2-AH-10,The ACSC guidance for hardening Microsoft Office is implemented.,Use the Microsoft Policy Analyzer to validate the effective state of the system against the Microsoft Office security baseline.
,,,OR,
,,,The Microsoft guidance for hardening Microsoft Office is implemented.,
,,ML2-AH-11,Vendor guidance for hardening PDF software is implemented.,"Determine the PDF software in use, and if the vendor provides hardening guidance for the product. Follow the guidance to determine if the product has been hardened."
,,,,Adobe Acrobat Reader hardening guidance can be found at https://www.adobe.com/devnetdocs/acrobatetk/tools/AppSec/Acrobat%20Application%20Security%20Guide.pdf.
,Blocked PowerShell script execution events are logged. ,ML2-AH-12,PowerShell scripts that have been blocked are logged.,"Verify event logs contain required data (does not require central storage). Note, if application control is used to restrict the execution of scripts, PowerShell script execution events may already be captured. Ensure all systems are logging. "
Restrict administrative privileges ,Privileged access to systems and applications is automatically disabled after 12 months unless revalidated. ,ML2-RA-01,A process for disabling known privileged accounts exists and is enforced. Users are made aware of this requirement when being provisioned with a privileged account.,"Review documented process to disable privileged access after 12 months. Review evidence, such as support tickets, emails, logs, or the automated disabling procedure, to confirm accounts are disabled after 12 months unless revalidated."
,,ML2-RA-02,There are no privileged accounts that have an Active Directory expiry date that is greater than 12 months or do not have an expiry date.,Query Active Directory using PowerShell commands or tools such as ADRecon to identify accounts with distant or no expiry dates.
,,,,The following PowerShell command returns privileged accounts with no account expiry set.
,,,,"Get-ADUser -Filter {(admincount -eq 1) -and (enabled -eq $true)} -Properties AccountExpirationDate | Where-Object {$_.AccountExpirationDate -like “” | Select @{n=‘Username’; e={$_.SamAccountName}}, @{n=‘Account Expiration Date’; e={$_.AccountExpirationDate}}, @{n=‘Enabled’; e={$_.Enabled}}"
,,,,The following PowerShell command returns any privileged accounts that have an expiry date greater than 12 months.  
,,,,Get-ADUser -Filter {(admincount -eq 1) -and (enabled -eq $true)} -Properties AccountExpirationDate | Where-Object 
,,,,"{$_.AccountExpirationDate -gt (Get-Date).AddMonths(12)} | Select @{n=‘Username’; e={$_.SamAccountName}}, @{n=‘Account Expiration Date’; e={$_.AccountExpirationDate}}, @{n=‘Enabled’; e={$_.Enabled}} "
,Privileged access to systems and applications is automatically disabled after 45 days of inactivity. ,ML2-RA-03,"A process for disabling privileged accounts that have not been used for 45 days exists and is enforced by the entity. Evidence exists for the usage of the 45 days inactive disabling process, including support tickets or administrative logs that show accounts were disabled.","Review documented process to disable privileged access after 45 days of inactivity. Review evidence, such as support tickets, automated disabling procedure to confirm accounts have been disabled."
,,ML2-RA-04,There are no enabled privileged accounts that have a lastlogondate that is greater than 45 days.,Query Active Directory using PowerShell commands or tools such as ADRecon to identify enabled privileged accounts with a ‘lastlogondate’ greater than 45 days.
,,,,"Get-ADUser -Filter {(admincount -eq 1) -and (enabled -eq $true)} -Properties LastLogonDate | Where-Object {$_.LastLogonDate -lt (Get-Date).AddDays(-45) -and$_.LastLogonDate -ne $null} | Select @{n=‘Username’; e={$_.samaccountname}}, @{n=‘Last Logon Date’; e={$_.LastLogonDate}}, @{n=‘Enabled’; e={$_.enabled}}"
,Privileged operating environments are not virtualised within unprivileged operating environments. ,ML2-RA-05,"Where a privileged environment is virtualised, the virtualised image is not located in an unprivileged environment. This includes virtual machines on a standard unprivileged SOE.",Confirm with the entity where the privileged environment infrastructure is hosted. Look for privileged environments on unprivileged virtual hosts and SOE workstations.
,Administrative activities are conducted through jump servers. ,ML2-RA-06,Servers are configured to not allow remote access traffic or connections from systems that are not jump servers.,Attempt to connect to servers or administrator-only systems from an unprivileged environment. Verify Firewall configuration.
,"Credentials for local administrator accounts and service accounts are long, unique, unpredictable and managed. ",ML2-RA-07,The Microsoft Local Administrator Password Solution (LAPS) or a similar solution is implemented on Windows workstations and servers.,Run the following PowerShell commands to retrieve the number of computers with LAPS and compare with the number of computers in Active Directory.
,,,,Run the following PowerShell command to get number of computers with LAPS.
,,,, Get-ADComputer -Filter {ms-Mcs-AdmPwdExpirationTime -like “*”} -Properties ms-Mcs-AdmPwdExpirationTime | measure Run the following PowerShell command to get the number of enabled computers in Active Directory.
,,,,Get-ADComputer -Filter {Enabled -eq $true} | measure
,,ML2-RA-08,"Services account passwords are generated to be long, unique and unpredictable. Service account passwords are stored in a secure location, such as a password manager or a Privileged Access Management solution.","Observe evidence of a password management or privileged access management solution in use for managing service account passwords. Ensure generated passwords are unique, unpredictable, and have a minimum length requirement. Look for accounts with identical passwords."
,,,,"Confirm how passwords are generated for local accounts, and that they are managed. If using LAPS for local accounts, check the following group policy setting Computer Configuration/Administrative Templates/LAPS/Password Settings."
,,ML2-RA-09,Passwords should be changed at least once every 12 months.,Query Active Directory using PowerShell commands or tools such as ADRecon to identify service accounts with passwords last set more than 12 months ago.
,,,,Run the following PowerShell command to get service accounts with passwords older than 12 months. Replace SVC_* with service account naming convention.  
,,,,$PassLastSetTimeFrame = (Get-Date).AddMonths(-12) 
,,,,"Get-ADUser -Filter “enabled -eq ‘true’ -and SamAccountName -like ‘SVC_*’” -Properties pwdlastset | Where-Object{$_.pwdlastset -like ‘0’ -or ([datetime]::FromFileTime($_.pwdLastSet) -lt $PassLastSetTimeFrame)} | Select-Object SAMAccountName, @{name =“pwdLastSet”; expression={([datetime]::FromFileTime($_.pwdLastSet))}} "
,Privileged access events are logged. ,ML2-RA-10,Successful and failed logins of privileged accounts are logged.,"Event logs need to be retained/backed up for a minimum period, so they are available if required. Verify the existence of the following event logs."
,,,,Event ID 4672 is created when an account with special privileges successfully logs in.
,,,,Event ID 4625 is created when a logon request fails.
,Privileged account and group management events are logged. ,ML2-RA-11,Changes made to privileged accounts and groups within Active Directory are logged.,"Event logs need to be retained/backed up for a minimum period, so they are available if required. Verify the existence of the following event logs."
,,,,Event ID 4738 is created when a user account is modified in Active Directory.
,,,,Event ID 4728 is created when a member is added to an Active Directory Security Group.
,,,,Event ID 4729 is created when a member is removed from an Active Directory Security Group.
,,,,Event ID 4737 is created when a change is made to an Active Directory Security Group.
Patch operating systems ,A vulnerability scanner is used at least weekly to identify missing patches or updates for security vulnerabilities in operating systems of,ML2-PO-01,A vulnerability scanner is run and reviewed at least weekly to scan the organisation’s operating systems.,"Confirm that a vulnerability scanner is in place, and it is configured to scan the organisation’s operating systems, typically requiring a credentialed scan. Confirm that reports from the vulnerability scanner are reviewed by the responsible staff weekly, and that identified issues have been observed and actioned."
,"workstations, servers and network devices. ",,,
,"Patches, updates or vendor mitigations for security vulnerabilities in operating systems of workstations, servers and network devices are applied within two weeks of release.",ML2-PO-02,The organisation has an effective process for patching operating systems within two weeks.,"Confirm the existence of a list of managed operating systems, and where they are located. Ensure a process for identifying vulnerabilities for operating systems in the list is consistently followed. Request evidence of the patching of these systems within two weeks."
,,ML2-PO-03,Operating systems that have a vulnerability are patched or mitigated within two weeks.,Use vulnerability management solution to perform a patch audit of all systems.
,,,,"Retrieve the update history of the system, noting the release date of the patch and the date it was installed. Look for differences greater than two weeks."
Multi-factor authentication ,Multi-factor authentication is used to authenticate privileged users of systems. ,ML2-MF-01,A privileged user who is performing administrative activities is required to respond to an MFA challenge at some point in the authentication lifecycle. This can be implemented when authenticating to a machine (such as a jump server) or when attempting to raise privileges. The organisation has a list of systems that have privileged users or support privileged functions.,Verify a privileged user is presented with a MFA challenge when authenticating to a machine or attempting to raise privileges.
,,,,Confirm the organisation has a list of privileged systems and is regularly updated.
,"Multi-factor authentication uses either: something users have and something users know, or something users have that is unlocked by something users know or are. ",ML2-MF-02,"The organisation requires that internet-facing services use multi-factor authentication that uses either: something users have and something users know, or something users have that is unlocked by something users know or are.",Verify MFA for internet-facing services uses either:
,,,,"Something users have (e.g. look-up secrets, out-of-band devices, single-factor OTP devices, single-factor cryptographic software or single-factor cryptographic devices) AND something users know (e.g. memorised secrets)"
,,,,OR
,,,,"Something users have that is unlocked by something users know or are (e.g. multi-factor OTP devices, multi-factor cryptographic software and multi-factor cryptographic devices)"
,,ML2-MF-03,"The organisation requires that privileged users utilise multi-factor authentication that uses either: something users have and something users know, or something users have that is unlocked by something users know or are.",Verify MFA for internet-facing services uses either:
,Successful and unsuccessful multifactor authentication events are logged. ,ML2-MF-04,The organisation’s internet-facing systems log successful MFA attempts.,Verify successful MFA events are logged for organisations internet-facing systems.
,,ML2-MF-05,Administrative access connections log successful MFA attempts.,Verify successful MFA events are logged for administrative access.
,,ML2-MF-06,The organisation’s internet-facing systems log unsuccessful MFA attempts.,Verify unsuccessful MFA events are logged for organisations internet-facing systems.
,,ML2-MF-07,Administrative access connections log unsuccessful MFA attempts.,Verify unsuccessful MFA events are logged for administrative access.
Regular backups ,Privileged accounts (excluding backup administrator accounts) cannot access backups belonging to other accounts. ,ML2-RB-01,Privileged users (excluding backup administrator accounts) are unable to access backups that do not belong to them.,Verify access controls restrict the access of backups to the owner of the backup and backup administrator accounts.
Application control ,Application control is implemented on workstations and servers.,ML3-AC-01,(Servers) A dedicated application control solution is implemented.,Check whether an in-built or third-party application control solution has been implemented.
,"Application control restricts the execution of executables, software libraries,",ML3-AC-02,(Servers) The system is only able to execute approved executables.,Attempt to run a non-approved executable in a directory that is not part of an application control path-based rule.
,"compiled HTML, HTML applications, control panel applets and drivers to an organisation-approved set.",ML3-AC-03,(Servers) The system is only able to execute approved software libraries.,Attempt to run a non-approved software library (DLL) in a directory that is not part of an application control path-based rule.
,,ML3-AC-04,(Servers) The system is only able to execute approved scripts.,"Attempt to run a non-approved software script (vbs, ps1, py) in a directory that is not part of an application control path-based rule."
,,,,"If the environment includes Python, VBA, or other scripting languages, consider testing additional scripts for these languages."
,,ML3-AC-05,(Servers) The system is only able to execute approved installers.,Attempt to run a non-approved installer (msi) in a directory that is not part of an application control path-based rule.
,,ML3-AC-06,(Servers) The system is only able to execute approved compiled HTML files.,Attempt to run a non-approved compiled HTML file (CHM) in a directory that is not part of an application control path-based rule.
,,ML3-AC-07,(Servers) The system is only able to execute approved HTML applications.,Attempt to run a non-approved HTML application in a directory that is not part of an application control path-based rule.
,,,,E8MVT will attempt to run a HTML Application file within the local AppData temp directory.
,,ML3-AC-08,(Servers) The system is only able to execute approved control panel applets.,Attempt to run a non-approved Control Panel applet in a directory that is not part of an application control path-based rule.
,,ML3-AC-09,(Workstations & Servers) The system is only able to execute approved drivers.,Attempt to run a non-approved driver in a directory that is not part of an application control path-based rule.
,Microsoft’s ,ML3-AC-10,(Workstations & Servers) The Microsoft recommended Block rules are configured on the system.,"Attempt to run a binary that is on the recommended block list such as wmic, mshta or wscript."
,‘recommended block rules’ are implemented. ,,,E8MVT will retrieve the latest version of the block list rules from Microsoft. It will compare each of these rules against those configured on the system and return a failed result if any do not match. This will not consider any rules that are determined to be necessary for business purposes and are risk managed.
,Microsoft’s ,ML3-AC-11,(Workstations & Servers) The Microsoft recommended driver Block rules are configured on the system.,"Attempt to install a driver that is on the recommended block list. Verify rules for the blocked drivers exist in an application control configuration, and that they are enforced."
,‘recommended driver ,,,
,block rules’ are implemented. ,,,E8MVT will retrieve the latest version of the block list rules from Microsoft. It will compare each of these rules against those configured on the system and return a failed result if any do not match. This will not consider any rules that are determined to be necessary for business purposes and are risk managed.
,Application control rulesets are validated on an annual or more frequent basis. ,ML3-AC-12,The organisational list of allowed applications rules are reviewed for accuracy with current business requirements and threat profiles.,Check that the Application Control owner has a process for reviewing the list of allowed applications on an annual or more frequent basis. Mature organisations will outline the process of assessing threats in applications and what supporting business case details are required from the requesting group.
,,,,"Check that there is evidence that the organisation has enacted the annual application list review within the last 12 months. This evidence will typically exist as support tickets, email correspondence, or threat and risk assessments."
,Allowed and blocked execution events on workstations and servers are centrally logged.,ML3-AC-13,(Workstations & Servers) Application control event logs are sent to a centralised location.,Verify event logs for each required event are collected at a centralised location.
,,,,Verify the number of systems logging to this location align with total expected systems (i.e. all systems are logging here).
,Event logs are protected from unauthorised modification and deletion. ,ML3-AC-14,Application control event logs are protected from unauthorised modification and deletion.,Verify standard and unauthorised users are unable to modify or delete event logs.
,Event logs are monitored for signs of compromise and actioned when any signs of compromise are detected. ,ML3-AC-15,Application control event logs are monitored for signs of compromise.,Verify a process is in place to monitor application control event logs for signs of compromise. Verify the information gathered is sufficient to effectively identify compromise.
,,,,"Look for evidence that this process is being followed. This evidence will typically exist as support tickets, email correspondence, or threat and risk assessments."
,,ML3-AC-16,The organisation has an example where they investigated or responded to signs of compromise triggered by application control monitoring.,"Verify the organisation has responded to a sign of compromise trigged by application control monitoring. This evidence will typically exist as support tickets, email correspondence or threat and risk assessments."
Patch applications ,"Patches, updates or vendor mitigations for security vulnerabilities in office productivity suites, web browsers and their extensions, email clients, PDF software, and security products are applied within two weeks of release, or within 48 hours if an exploit exists.",ML3-PA-01,"The organisation has an effective process for patching office productivity suites, web browsers, email clients, PDF software and security products within 48 hours, and has an example of where an available exploit has been identified and patched within 48 hours.","Confirm the existence of a list of applications, and where the applications are installed. Ensure a process for identifying vulnerabilities for software in the list is consistently followed. Request evidence of the patching of these applications within 48 hours."
,,ML3-PA-02,"Office productivity suites, web browsers, email clients, PDF software and security products do not have security vulnerabilities older than 48 hours.","Use a vulnerability scanner to identify the listed applications within the organisation’s environment, and check that they have been patched against a known exploit. Check the date the application was updated and compare to the date the patch was released. Ensure that the gap between is not greater than 48 hours."
,Applications that are no longer supported by vendors are removed.,ML3-PA-03,The organisation has removed unsupported applications from the environment.,Confirm that the environment does not contain any software that is no longer supported by the vendor.
Configure Microsoft Office macro settings ,"Only Microsoft Office macros running from within a sandboxed environment, a Trusted Location or that are digitally signed by a trusted publisher are allowed to execute. ",ML3-OM-01,Microsoft Office is configured to only allow Microsoft Office macros to execute from trusted locations.,"Attempt to execute Microsoft Office macros from untrusted locations, and trusted locations if configured."
,,,OR,OR
,,,Microsoft Office is configured to only allow Microsoft Office macros digitally signed by a trusted publisher to execute.,"Attempt to execute signed and unsigned Microsoft Office macros from untrusted publishers, and trusted publishers if configured."
,,,Microsoft Office macros are only executed from within a sandbox environment.,Determine if a sandbox solution is in place and effective for Microsoft Office. An example of this would be Application Guard for Office 365.
,Only privileged users responsible for validating that Microsoft Office macros are free of malicious code can write to and modify content within ,ML3-OM-02,The organisational has a defined standard for validating and accepting Microsoft Office macros in Microsoft Office files before adding them to the trusted location.,"Confirm that trusted locations are used by the organisation. If so, check that a process exists for allowing write access to these locations and that users with this level of access are validating that Microsoft Office macros are free of malicious code."
,Trusted Locations. ,ML3-OM-03,A user is not able to write a file into locations contained within the trusted locations list.,Get trusted locations for each product from the registry at
,,,,HKCU:\software\microsoft\office\<version>\<product>\security\trusted locations and attempt to write a file into each of these locations.
,,,,E8MVT will find configured Trusted Locations and attempt to write a file to each location.
,,,,Get-ItemProperty -Path “HKCU:\SOFTWARE\policies\microsoft\office\<version>\<product>\security\trusted locations” 
,Microsoft Office macros digitally signed by an untrusted publisher cannot be enabled via the Message Bar or ,ML3-OM-04,"Microsoft Office macros signed by an untrusted publisher are unable to execute, and users cannot change configuration or otherwise allow execution.",Attempt to execute Microsoft Office macros in a Microsoft Office file signed by an untrusted publisher.
,Backstage View. ,,,Check the value in the registry to confirm that TCID19092 exists for each product
,,,,HKEY_CURRENT_USER\SOFTWARE\Policies\Microsoft\office\<version>\<product>\disabledcmdbaritemslist.
,,,,Check the value is set to 1 at HKCU:\Software\Microsoft\Office\16.0\Common\TrustCenter\trustbar.
,,,,Get-ItemProperty -Path “HKCU:\SOFTWARE\Policies\Microsoft\office\<version>\<product>\” | Select-Object -Property disabledcmdbaritemslist
,,,,Example: Get-ItemProperty -Path “HKCU:\SOFTWARE\Policies\Microsoft\office\16.0\word\” | Select-Object -Property disabledcmdbaritemslist
,,,,Get-ItemProperty -Path “HKCU:\SOFTWARE\Policies\Microsoft\office\<version>\Common\TrustCenter\” | Select-Object -Property trustbar 
,,,,Example: Get-ItemProperty -Path “HKCU:\SOFTWARE\Policies\Microsoft\office\16.0\Common\TrustCenter\” | Select-Object -
,,,,Property trustbar
,Microsoft Office’s list of trusted publishers is validated on an annual or more frequent basis. ,ML3-OM-05,The organisation has a process for validating the listed of trusted publishers on an annual or more frequent basis.,Confirm that a list of trusted publishers exists and that a process is in place to regularly review this list to allow/remove trusted publishers. Request evidence of an annual validation having taken place.
,Allowed and blocked Microsoft Office macro execution events are centrally logged.,ML3-OM-06,Microsoft Office macro execution event logs are sent to a centralised location.,Verify event logs for each required event are collected at a centralised location. Verify the number of systems logging to this location align with total expected systems (i.e. all systems are logging here).
,Event logs are protected from unauthorised ,ML3-OM-07,Microsoft Office macro execution event logs are protected from unauthorised modification and deletion.,Verify standard and unauthorised users are unable to modify or delete Microsoft Office macro execution event logs.
,modification and deletion. ,,,
,Event logs are monitored for signs of compromise and actioned when any signs of compromise are detected. ,ML3-OM-08,Microsoft Office macro execution event logs are monitored for signs of compromise.,Verify a solution or process is in place to monitor the Microsoft Office macro execution event logs for signs of compromise. Check that the environment owner has a process for detecting and handling any signs of compromise relating to Microsoft Office macro execution.
,,ML3-OM-09,The organisation has an example where they investigated or responded to signs of compromise triggered by Microsoft Office macro execution monitoring.,"Verify the organisation has responded to a sign of compromise trigged by Microsoft Office macro execution monitoring. This evidence will typically exist as support tickets, email correspondence or threat and risk assessments."
User application hardening ,Internet Explorer 11 is disabled or removed.,ML3-AH-01,The Internet Explorer 11 binary (iexplore.exe) does not exist on the system or is not able to be opened due to an application control policy.,"E8MVT will perform a check of the group policy setting to disable Internet Explorer 11. In addition, check that the folder containing Internet Explorer 11 in Program Files (x86) has been removed and that the iexplore.exe binary does not exist on the system."
,,,,E8MVT will check for the existence of the iexplore.exe binary in Program Files.Get-ItemProperty -Path 
,,,,“(HCKU/HKLM):\Software\Policies\Microsoft\Internet Explorer\Main\” | Select-Object -Property NotifyDisableIEOptions.
,,,,"Note, even in Microsoft Windows 11, the C:\Program Files (x86)\Internet Explorer\iexplore.exe binary still exists and various methods can be used to open Internet Explorer 11 as a standalone browser. To prevent this from occurring, either the iexplore.exe binary should be removed or an application control block rule is implemented to block its execution."
,.NET Framework 3.5 ,ML3-AH-02,.NET Framework 3.5 has been removed from the system by unselecting it from the list of optional Windows Features.,Select the ‘Turn Windows Features on or off’ option from the Control Panel and confirm that .NET Framework (includes .NET 2.0 and 3.0) is not selected.
,(includes .NET 2.0 and ,,,
,3.0) is disabled or removed. ,ML3-AH-03,Older .NET Frameworks are unable to be found in the registry.,Check the registry keys below for the existence of older .NET Frameworks.
,,,,E8MVT will check this location to determine if older .NET Framework versions exist on the system.
,,,,Get-ChildItem -Path “HKLM:\SOFTWARE\Microsoft\NET Framework Setup\NDP” 
,,,,Get-ChildItem -Path “HKLM:\Software\Microsoft\.NETFramework\Policy\” 
,Windows PowerShell ,ML3-AH-04,PowerShell 2.0 and below has been removed from the system and traces of it cannot be found in the registry.,Run the following PowerShell command Get-ChildItem “HKLM:\SOFTWARE\Microsoft” -Recurse -Include PowerShellEngine and confirm that version 2.0 is not found in the results. The PowerShell command $PSVersionTable will display a list of supported PowerShell versions. Ensure that 2.0 and below is not part of this list. The command $PSVersionTable.PSVersion.Major can be used to confirm the running version.
,2.0 is disabled or removed. ,,,E8MVT will check the described registry key to locate old PowerShell versions.
,,,,Get-ChildItem “HKLM:\SOFTWARE\Microsoft\Powershell” -Recurse -Include PowerShellEngine 
,,ML3-AH-05,PowerShell cannot be downgraded to version 2.0 or below.,Enter powershell -Version 2 into a PowerShell prompt to check if the system can be downgraded. The command $PSVersionTable.PSVersion.Major can be used to confirm the running version.
,PowerShell is configured to use Constrained Language Mode. ,ML3-AH-06,The default configuration for PowerShell on the system is to start in Constrained Language Mode.,Run $ExecutionContext.SessionState.LanguageMode in PowerShell to check if ConstrainedLanguage is configured.
,,,,E8MVT will not run if the system is configured for Constrained Language Mode.
,,ML3-AH-07,PowerShell will not allow a user to change to Full Language mode.,"Confirm that PowerShell is running in CLM. Run $ExecutionContext.SessionState.LanguageMode = ‘FullLanguage’ in PowerShell. If the mode can change, the test has failed."
,Blocked PowerShell script execution events are centrally logged.,ML3-AH-08,PowerShell script execution event logs are sent to a centralised location.,Verify event logs for each required event are collected at a centralised location.
,Event logs are protected from unauthorised modification and deletion. ,ML3-AH-09,PowerShell script execution event logs are protected from unauthorised modification and deletion.,Verify standard and unauthorised users are unable to modify or delete event logs.
,Event logs are monitored for signs of compromise and actioned when any signs of compromise are detected. ,ML3-AH-10,PowerShell script execution event logs are monitored for signs of compromise.,Verify a solution or process is in place to monitor the PowerShell script execution event logs for signs of compromise. Check that the environment owner has a process for detecting and handling any signs of compromise relating to PowerShell script execution.
,,ML3-AH-11,The organisation has an example where they investigated or responded to signs of compromise triggered by PowerShell script execution monitoring.,"Verify the organisation has responded to a sign of compromise trigged by PowerShell script execution monitoring. This evidence will typically exist as support tickets, email correspondence or threat and risk assessments."
Restrict administrative privileges ,Privileged access to systems and applications is limited to only what is required for users and services to undertake their duties. ,ML3-RA-01,The existing users of systems and applications are provided with the correct level of privilege required to perform their duties.,Review the configured users of systems and applications. Ensure their assigned privileges match their expected duties and role. Query Active Directory using PowerShell commands or tools such as Bloodhound and ADRecon to identify users with more privileges than required in their role. Ensure privileged Active Directory groups such as Domain Administrators have limited members.
,"Privileged accounts are prevented from accessing the internet, email and web services.",ML3-RA-02,"Service accounts cannot access the internet or web services via a web browser or other mechanism. This might be due to a proxy configuration, system configuration, or another solution.","While logged in as a service account, attempt to browse to an internet website. Review the configuration preventing internet access and attempt to change this as a privileged user not responsible for administering that system."
,,ML3-RA-03,Service accounts are not configured with mailboxes and email addresses. Note tests for Maturity Level One already cover internet restrictions for privileged accounts excluding service accounts.,Attempt to open Microsoft Outlook on a system using a service account. Run the following PowerShell command and identify any service accounts in the output.  
,,,,"Get-ADUser -Filter {(admincount -eq 1) -and (emailaddress -like “*”) -and (enabled -eq $true)} -Properties EmailAddress | Select samaccountname, emailaddress"
,Just-in-time administration is used for administering systems and applications. ,ML3-RA-04,Groups that are identified as having privileged access to systems and applications contain no active users.,"Query Active Directory using PowerShell commands or tools such as ADRecon to identify privileged users and groups. Consider some users may currently have Just-in-time access, and ensure they are not permanently members of a privileged group."
,,ML3-RA-05,Users that are approved access to privileged administration groups are provided with access for a limited time to fulfil their duties. A Just-in-time administration solution has been successfully deployed and configured.,"Review evidence of valid use of this system, such as service requests or support tickets. Look for evidence of this solution being bypassed, such as users in privileged groups for extended periods of time. Ensure the system configuration meets the intent of this control, such as limiting who can receive privileged access."
,Windows Defender ,ML3-RA-06,Windows Defender Credential Guard is enabled on the system.,Check the registry setting at HKLM:\System\CurrentControlSet\Control\LSA\ and confirm that LsaCfgFlags is set to 1 or 2.
,Credential Guard and ,,,Can also check using the PS command (Get-CimInstance -ClassName Win32_DeviceGuard -Namespace root\Microsoft\Windows\DeviceGuard).SecurityServicesRunning and confirming that the result = 1.
,Windows Defender Remote Credential ,,,E8MVT is able to check the registry setting for this control.
,Guard are enabled. ,,,Get-ItemProperty -Path “HKLM:\System\CurrentControlSet\Control\LSA\” | Select-Object -Property lsacfgflags* 
,,ML3-RA-07,Windows Defender Remote Credential Guard is enabled on the system.,Check the registry setting at HKLM:\System\CurrentControlSet\Control\LSA\ and confirm that DisableRestrictedAdmin is set to 0.
,,,,E8MVT is able to check the registry setting for this control.
,,,,Get-ItemProperty -Path “HKLM:\System\CurrentControlSet\Control\LSA\” | Select-Object -Property DisabledRestrictedAdmin 
,Privileged access events are centrally logged.,ML3-RA-08,Privileged access event logs are sent to a centralised location.,Verify event logs for each required event are collected at a centralised location.
,Privileged account and group management events are centrally logged.  ,ML3-RA-09,Privileged account and group management event logs are sent to a centralised location.,Verify event logs for each required event are collected at a centralised location.
,Event logs are protected from unauthorised modification and deletion. ,ML3-RA-10,Privileged access event logs are protected from unauthorised modification and deletion.,Verify standard and unauthorised users are unable to modify or delete event logs.
,,ML3-RA-11,Privileged account and group management event logs are protected from unauthorised modification and deletion.,Verify standard and unauthorised users are unable to modify or delete event logs.
,Event logs are monitored for signs of compromise and actioned when any signs of compromise are detected. ,ML3-RA-12,Privileged access event logs are monitored for signs of compromise.,Verify a solution or process is in place to monitor the privileged access event logs for signs of compromise. Check that the environment owner has a process for detecting and handling any signs of compromise relating to privileged access.
,,ML3-RA-13,The organisation has an example where they investigated or responded to signs of compromise triggered by privileged access monitoring.,"Verify the organisation has responded to a sign of compromise trigged by privileged access monitoring. This evidence will typically exist as support tickets, email correspondence or threat and risk assessments."
,,ML3-RA-14,Privileged account and group management event logs are monitored for signs of compromise.,Verify a solution or process is in place to monitor the privileged account and group management event logs for signs of compromise. Check that the environment owner has a process for detecting and handling any signs of compromise relating to privileged account and group management.
,,ML3-RA-15,The organisation has an example where they investigated or responded to signs of compromise event triggered by privileged account and group management monitoring.,"Verify the organisation has responded to a sign of compromise trigged by privileged account and group management monitoring. This evidence will typically exist as support tickets, email correspondence or threat and risk assessments."
Patch operating systems ,"Patches, updates or vendor mitigations for security vulnerabilities in operating systems of workstations, servers and network devices are applied within two weeks of release, or within 48 hours if an exploit exists.",ML3-PO-01,Operating systems vulnerable to an exploit that has been available for greater than 48 hours are patched or mitigated.,"View vulnerability management solution, logon to server to verify patch applied successfully or review mitigation strategy."
,"The latest release, or the previous release, of operating systems are used for. ",ML3-PO-02,"The minimum version of the operating system is the current, or previous release (N-1 version).",Query Active Directory using PowerShell commands or tools such as ADRecon or Bloodhound to identify operating system versions within the environment. Use a vulnerability management solution to scan all systems to record their operating system version.
,,ML3-MF-01,The organisation has a list of important data repositories.,Confirm the organisation has a list of important data repositories and this list is regularly checked.
Multi-factor authentication ,Multi-factor authentication is used to authenticate users accessing important data repositories. ,ML3-MF-02,Data repositories that have been listed as important require MFA to access.,Verify important data repositories are configured to present a MFA challenge.
,,,,The organisation will determine important / sensitive data repositories.
,"Multi-factor authentication is phishing-resistant and uses either: something users have and something users know, or something users have that is unlocked by something users know or are.",ML3-MF-03,The MFA implementation requires the use of a phishing-resistant solution.,"Verify that MFA requires a smart card, security key, Windows Hello for Business or any other solution this is resistant to phishing attacks."
,Successful and unsuccessful multifactor authentication events are centrally logged.,ML3-MF-04,MFA event logs are sent to a centralised location.,Verify event logs for each required event are collected at a centralised location.
,Event logs are protected from unauthorised modification and deletion. ,ML3-MF-05,MFA event logs are protected from unauthorised modification and deletion.,Verify standard and unauthorised users are unable to modify or delete event logs.
,Event logs are monitored for signs of compromise and actioned when any signs of compromise are detected. ,ML3-MF-06,MFA event logs are monitored for signs of compromise.,Verify a solution or process is in place to monitor the integrity and validity of MFA event logs.
,,ML3-MF-07,The organisation has an example where they investigated or responded to signs of compromise triggered by MFA monitoring.,"Verify the organisation has responded to a sign of compromise trigged by MFA monitoring. This evidence will typically exist as support tickets, email correspondence or threat and risk assessments."
Regular backups ,"Unprivileged accounts cannot access backups belonging to other accounts, nor their own accounts.",ML3-RB-01,"Unprivileged users are unable to access backups, including their own.",Verify access controls restrict unprivileged users from accessing backup repositories.
,"Privileged accounts (excluding backup administrator accounts) cannot access backups belonging to other accounts, nor their own accounts.",ML3-RB-02,"Privileged users (excluding backup administrator accounts) are unable to access backups, including their own.",Verify access controls restrict privileged users (excluding backup administrator accounts) from accessing backup repositories.
 ,,,,